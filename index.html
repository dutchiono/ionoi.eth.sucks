<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="public, max-age=604800">
    <meta name="description" content="lean Projects + Musings inspired by wojtek.im/projects">
    <meta property="og:type" content="website">
    <meta property="og:title" content="ionoi.eth.sucks | Projects">
    <meta property="og:description" content="Everything Dutch is currently working on, styled like wojtek.im/projects.">
    <meta property="og:image" content="https://dutchiono.github.io/ionoi.eth.sucks/image.png">
    <meta property="og:url" content="https://dutchiono.github.io/ionoi.eth.sucks">
    <meta name="fc:miniapp" content='{"version":"1","name":"Ionoi Purple Lab","iconUrl":"https://dutchiono.github.io/ionoi.eth.sucks/icon.png","homeUrl":"https://dutchiono.github.io/ionoi.eth.sucks","imageUrl":"https://dutchiono.github.io/ionoi.eth.sucks/image.png","buttonTitle":"Open","splashImageUrl":"https://dutchiono.github.io/ionoi.eth.sucks/splash.png","splashBackgroundColor":"#0b0d1b"}'>
    <script src="https://unpkg.com/@farcaster/miniapp-sdk@latest/dist/index.umd.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>ionoi.eth.sucks | Projects</title>
</head>
<body>
    <div class="page">
        <nav class="top-nav">
            <a class="logo" href="#home"><img src="dutchgif.gif" alt="dutch" class="logo-gif"></a>
            <div class="tab-links">
                <button class="tab active" data-tab="home">Home</button>
                <button class="tab" data-tab="projects">Projects</button>
                <button class="tab" data-tab="journal">Musings</button>
                <a class="tab" href="pitch-round-robin.html">Pitch</a>
            </div>
        </nav>
        <div class="social-links-nav">
            <a href="https://warpcast.com/ionoi" target="_blank" rel="noreferrer">Warpcast</a>
            <a href="https://x.com/ionoi" target="_blank" rel="noreferrer">X</a>
            <a href="https://t.me/dutchiono" target="_blank" rel="noreferrer">Telegram</a>
            <a href="https://discord.com/users/dutchiono" target="_blank" rel="noreferrer">Discord</a>
            <a href="https://github.com/dutchiono" target="_blank" rel="noreferrer">GitHub</a>
            <a href="mailto:dutchiono@gmail.com">Email</a>
        </div>

        <main class="content">
            <section id="home" class="tab-panel active">
                <header class="page-heading">
                    <h1>Hello from Dutch</h1>
                </header>
                <p>I come from a blue-collar background, and most of what I know comes from teaching myself, taking things apart, and building until they work. I've been pushing hard to break into tech by creating real projects — automation tools, crypto systems, AI agents, and anything else I can learn my way into. I'm not here to impress anyone — I just want to create stuff that matters.</p>
            </section>

            <section id="projects" class="tab-panel">
                <header class="page-heading">
                    <h1>Projects</h1>
                </header>

                <div id="project-list">
                    <!-- Projects will be loaded dynamically -->
                </div>
            </section>

            <section id="journal" class="tab-panel">
                <header class="page-heading">
                    <h1>Musings</h1>
                </header>
                <div id="journal-list">
                    <!-- Journal entries will be loaded dynamically -->
                </div>
            </section>
        </main>
    </div>

    <script>
        // Cache key for localStorage
        const CACHE_KEY = 'projects_data';
        const CACHE_DATE_KEY = 'projects_last_fetch_date';
        const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours

        // Check if cache is still valid
        function isCacheValid() {
            const lastFetch = localStorage.getItem(CACHE_DATE_KEY);
            if (!lastFetch) return false;
            return (Date.now() - parseInt(lastFetch)) < CACHE_DURATION;
        }

        const PROJECT_FILE = 'projects.json';

        async function loadProjects() {
            // Check if we have valid cached data
            if (isCacheValid()) {
                const cached = localStorage.getItem(CACHE_KEY);
                if (cached) {
                    const projectsData = JSON.parse(cached);
                    renderProjects(projectsData.projects);
                    renderJournal(projectsData.journal);
                    return;
                }
            }

            // Otherwise fetch fresh data
            try {
                const response = await fetch(PROJECT_FILE);
                const projectsData = await response.json();
                
                // Store in cache
                localStorage.setItem(CACHE_KEY, JSON.stringify(projectsData));
                localStorage.setItem(CACHE_DATE_KEY, Date.now().toString());

                renderProjects(projectsData.projects);
                renderJournal(projectsData.journal);
            } catch (error) {
                console.error('Failed to load projects:', error);
                document.getElementById('project-list').innerHTML = '<p class="error-message">A bug is stopping data from loading as I adjust. Don').t worry - we're on it! - Dutch</p>';
            }
        }

        function renderProjects(projects) {
            const container = document.getElementById('project-list');
            if (!projects || projects.length === 0) {
                container.innerHTML = '<p>No projects yet.</p>';
                return;
            }

            container.innerHTML = projects.map(project => `
                <article class="project-card">
                    <div class="project-header">
                        <h2>${project.name}</h2>
                        ${project.url ? `<a href="${project.url}" target="_blank" rel="noreferrer" class="project-link">↗</a>` : ''}
                    </div>
                    <div class="project-meta">
                        ${project.date ? `<span class="project-date">${project.date}</span>` : ''}
                        ${project.status ? `<span class="project-status">${project.status}</span>` : ''}
                    </div>
                    ${project.description ? `<p class="project-description">${project.description}</p>` : ''}
                    ${project.tags && project.tags.length > 0 ? `
                        <div class="project-tags">
                            ${project.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    ` : ''}
                </article>
            `).join('');
        }

        function renderJournal(journals) {
            const container = document.getElementById('journal-list');
            if (!journals || journals.length === 0) {
                container.innerHTML = '<p>No entries yet.</p>';
                return;
            }

            container.innerHTML = journals.map(entry => `
                <article class="journal-entry">
                    <header class="journal-header">
                        <h3>${entry.title}</h3>
                        ${entry.date ? `<time>${entry.date}</time>` : ''}
                    </header>
                    ${entry.content ? `<p>${entry.content}</p>` : ''}
                </article>
            `).join('');
        }

        // Tab switching logic
        const tabButtons = document.querySelectorAll('.tab');
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.dataset.tab;
                
                // Remove active class from all tabs and panels
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-panel').forEach(panel => panel.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding panel
                button.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Handle sharing from other apps within the frame
        document.addEventListener('DOMContentLoaded', () => {
            try {
                const { sdk } = window.farcasterSdk;
                sdk.actions.shareUrl({
                    url: 'https://dutchiono.github.io/ionoi.eth.sucks'
                });
            } catch(e) { /* not in Farcaster Frames context */ }
        });

        // Load projects when page loads
        loadProjects();
    </script>
</body>
</html>